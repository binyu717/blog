(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{402:function(e,t,a){"use strict";a.r(t);var n=a(54),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"推荐"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#推荐"}},[e._v("#")]),e._v(" 推荐")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.elastic.co/guide/cn/elasticsearch/guide/current/getting-started.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("官方文档"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"http://www.youmeek.com/category/elasticsearch/",target:"_blank",rel:"noopener noreferrer"}},[e._v("youmeek博客"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/ghost_leader/article/details/79023222",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考blog"),a("OutboundLink")],1)])]),e._v(" "),a("h2",{attrs:{id:"基本知识"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本知识"}},[e._v("#")]),e._v(" 基本知识")]),e._v(" "),a("ul",[a("li",[e._v("Cluster：集群，可以一个或多个节点，这些节点共同保存这个集群的数据。集群有一个名称，很重要，各个节点的配置就需要用到这个名称，节点是用集群名称加入到集群中的。")]),e._v(" "),a("li",[e._v("Node：节点，归属集群。如果整个集群就一个节点，那这个节点也就是这个集群本身。")]),e._v(" "),a("li",[e._v("Index：索引，类似数据库结构中的库，是一堆 document 的集合。索引名称必须全部是小写，不能用下划线开头，不能包含逗号。")]),e._v(" "),a("li",[e._v("Type：类型，类似数据库结构中的表。")]),e._v(" "),a("li",[e._v("Document：文档，Elasticsearch 中的最小数据单元，类似数据库结构中的一行数据。")]),e._v(" "),a("li",[e._v("Shard：分片。全称 primary shards（一般用在写操作）。Elasticsearch 可以将一个 Index 中的 Document 数据切分为多个 shard，分布在多台服务器上存储。\n创建的时候可以指定分片数量，创建完成后是不可修改的。")]),e._v(" "),a("li",[e._v("Replica：副本。全称 replica shards（一般读操作可以被分配到进行使用）。Replica 主要用来保证高可用（故障转移）、数据备份、增强高吞吐的并行搜索。")])]),e._v(" "),a("h2",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[e._v("#")]),e._v(" 安装")]),e._v(" "),a("ul",[a("li",[e._v("elasticsearch")]),e._v(" "),a("li",[e._v("kibana port:5601\n"),a("blockquote",[a("p",[e._v("下载版本要和es保持一致，否则运行不起来；\n修改config/kibana.yml配置 server.host、elasticsearch.url ...\n运行 ./bin/kibana")])])])]),e._v(" "),a("h2",{attrs:{id:"运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行"}},[e._v("#")]),e._v(" 运行")]),e._v(" "),a("ul",[a("li",[e._v("默认情况下es是不允许root账户启动的，需要为es配置独立的账户和组\n"),a("blockquote",[a("p",[e._v("groupadd elasticsearch_group"),a("br"),e._v("\nuseradd elasticsearch_user -g elasticsearch_group -s /sbin/nologin")])])]),e._v(" "),a("li",[e._v("命令\n"),a("blockquote",[a("p",[e._v("bin/elasticsearch -d"),a("br"),e._v("\n./bin/kibana")])])])]),e._v(" "),a("h2",{attrs:{id:"操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作"}},[e._v("#")]),e._v(" 操作")]),e._v(" "),a("ul",[a("li",[e._v("查询集群健康状况：GET /_cat/health?v\n"),a("ul",[a("li",[e._v("默认集群名字：elasticsearch\n集群颜色状态-绿色，最健康的状态，代表所有的分片包括备份都可用；黄色，基本的分片可用，但是备份不可用（也可能是没有备份）；红色，部分的分片可用，表明分片有一部分损坏。此时执行查询部分数据仍然可以查到，遇到这种情况，还是赶快解决比较好。")])])]),e._v(" "),a("li",[e._v("查询集群中有哪些索引：GET /_cat/indices?v")]),e._v(" "),a("li",[e._v("查询分片：GET /_cat/shards")]),e._v(" "),a("li",[e._v("新增索引：PUT /user_index\n"),a("ul",[a("li",[e._v("指定分片数和副本（分片数不可修改）")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('        PUT /user_index\n        {\n        "settings": {\n            "index": {\n            "number_of_shards": 5,\n            "number_of_replicas": 1\n            }\n        }\n        }\n')])])]),a("ul",[a("li",[e._v("修改副本")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('        PUT /user_index/_settings\n        {\n            "number_of_replicas": 2\n        }\n')])])]),a("ul",[a("li",[e._v("设置type/document\n"),a("ul",[a("li",[a("a",{attrs:{href:"https://www.elastic.co/guide/cn/elasticsearch/guide/current/mapping-intro.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("字段类型传送门"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("属性\n"),a("ul",[a("li",[e._v("index：可选值为analyzed/no/not_analyzed，analyzed:首先分析字符串，然后索引它。换句话说，以全文索引这个域。\nnot_analyzed:索引这个域，所以它能够被搜索，但索引的是精确值。不会对它进行分析。no:不索引这个域。这个域不会被搜索到。\nstring 域 index 属性默认是 analyzed 。如果我们想映射这个字段为一个精确值，我们需要设置它为 not_analyzed ：")]),e._v(" "),a("li",[e._v("boost：默认为1，定义了文档中该字段的重要性，越高越重要")]),e._v(" "),a("li",[e._v("include_in_all：指定该字段是否应该包括在_all字段里头，默认情况下都会包含。")]),e._v(" "),a("li",[e._v("对于 analyzed 字符串域，用 analyzer 属性指定在搜索和索引时使用的分析器,默认使用 standard 分析器， 但你可以指定一个内置的分析器替代它。")])])])])])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('PUT /user_index\n{\n    "settings":{\n        同上....\n    },\n   "mappings": {\n        "user": {\n            "properties": {\n                "id": {\n                "type": "text"\n                },\n                "user_name": {\n                "type": "keyword",\n                "boost": 5\n                },\n                "user_desc": {\n                "type": "text"\n                },\n                "age": {\n                "type": "byte"\n                },\n                "created_time": {\n                "type": "date",\n                "format": "yyyy-MM-dd HH:mm:ss"\n                },\n                "update_time": {\n                "type": "date",\n                "format": "yyyy-MM-dd HH:mm:ss"\n                }\n            }\n        }\n     }\n}\n\n')])])])]),e._v(" "),a("li",[e._v("在已有的mapping中增加域"),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('PUT /user_index/_mapping/user\n    {\n    "properties" : {\n        "introduce" : {\n        "type" :    "text"\n        }\n    }\n    }\n')])])])]),e._v(" "),a("li",[e._v("删除指定索引：DELETE /user_index")]),e._v(" "),a("li",[e._v("删除指定多个索引：DELETE /user_index,db_index")]),e._v(" "),a("li",[e._v("删除匹配符索引：DELETE /user_*")]),e._v(" "),a("li",[e._v("删除所有索引：DELETE /_all")]),e._v(" "),a("li",[e._v("查询索引配置信息：GET /user_index/_settings")]),e._v(" "),a("li",[e._v("查询所有索引配置信息：GET /_all/_settings")])]),e._v(" "),a("h2",{attrs:{id:"其他"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[e._v("#")]),e._v(" 其他")]),e._v(" "),a("ul",[a("li",[e._v("使用/_cat/nodes来查看所有node的情况\n"),a("blockquote",[a("p",[e._v("http://172.25.50.69:9200/_cat/nodes?v")])])]),e._v(" "),a("li",[e._v("分片情况\n"),a("blockquote",[a("p",[e._v("http://172.25.50.69:9200/_cat/shards?v")])])])])])}),[],!1,null,null,null);t.default=s.exports}}]);