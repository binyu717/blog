<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>推荐 | JAVA之路</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="shortcut icon" type="image/x-icon" href="./avatar.png">
    <meta name="description" content="行你所行，听从你心">
    
    <link rel="preload" href="/blog/assets/css/0.styles.b6bfb1ac.css" as="style"><link rel="preload" href="/blog/assets/js/app.f7a9413c.js" as="script"><link rel="preload" href="/blog/assets/js/2.ddedf7b8.js" as="script"><link rel="preload" href="/blog/assets/js/15.e4a62733.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.28823f80.js"><link rel="prefetch" href="/blog/assets/js/11.907d6de2.js"><link rel="prefetch" href="/blog/assets/js/12.e0480859.js"><link rel="prefetch" href="/blog/assets/js/13.197b8968.js"><link rel="prefetch" href="/blog/assets/js/14.327ec1cf.js"><link rel="prefetch" href="/blog/assets/js/16.7e8254c4.js"><link rel="prefetch" href="/blog/assets/js/17.a5fd2c58.js"><link rel="prefetch" href="/blog/assets/js/18.09512bd4.js"><link rel="prefetch" href="/blog/assets/js/19.4093ac92.js"><link rel="prefetch" href="/blog/assets/js/20.0a325460.js"><link rel="prefetch" href="/blog/assets/js/21.41949fa9.js"><link rel="prefetch" href="/blog/assets/js/22.aebd4cfb.js"><link rel="prefetch" href="/blog/assets/js/23.f9a7fbea.js"><link rel="prefetch" href="/blog/assets/js/24.e1b48ee8.js"><link rel="prefetch" href="/blog/assets/js/25.b990b784.js"><link rel="prefetch" href="/blog/assets/js/26.a87045c1.js"><link rel="prefetch" href="/blog/assets/js/27.054622f5.js"><link rel="prefetch" href="/blog/assets/js/28.641f720a.js"><link rel="prefetch" href="/blog/assets/js/29.4b365e5d.js"><link rel="prefetch" href="/blog/assets/js/3.b2bfae33.js"><link rel="prefetch" href="/blog/assets/js/30.46ac7154.js"><link rel="prefetch" href="/blog/assets/js/31.396b63a7.js"><link rel="prefetch" href="/blog/assets/js/32.27b8aea8.js"><link rel="prefetch" href="/blog/assets/js/33.2bdab81b.js"><link rel="prefetch" href="/blog/assets/js/34.0c7b821a.js"><link rel="prefetch" href="/blog/assets/js/35.2c48d1d3.js"><link rel="prefetch" href="/blog/assets/js/4.fbcf4621.js"><link rel="prefetch" href="/blog/assets/js/5.ec4b3f90.js"><link rel="prefetch" href="/blog/assets/js/6.27888615.js"><link rel="prefetch" href="/blog/assets/js/7.e23a1d77.js"><link rel="prefetch" href="/blog/assets/js/8.1314a140.js"><link rel="prefetch" href="/blog/assets/js/9.4472f6b1.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.b6bfb1ac.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">JAVA之路</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://caibaojian.com/vuepress/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vuepress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://caibaojian.com/vuepress/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vuepress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>java</span> <span class="arrow down"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mysql</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>oracle</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>postgresql</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>web</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mybatis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>maven</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>nginx</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>windows</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>单元测试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>问题积累</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>读书笔记</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="推荐"><a href="#推荐" class="header-anchor">#</a> 推荐</h2> <ul><li><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/getting-started.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://www.youmeek.com/category/elasticsearch/" target="_blank" rel="noopener noreferrer">youmeek博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/ghost_leader/article/details/79023222" target="_blank" rel="noopener noreferrer">参考blog<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="基本知识"><a href="#基本知识" class="header-anchor">#</a> 基本知识</h2> <ul><li>Cluster：集群，可以一个或多个节点，这些节点共同保存这个集群的数据。集群有一个名称，很重要，各个节点的配置就需要用到这个名称，节点是用集群名称加入到集群中的。</li> <li>Node：节点，归属集群。如果整个集群就一个节点，那这个节点也就是这个集群本身。</li> <li>Index：索引，类似数据库结构中的库，是一堆 document 的集合。索引名称必须全部是小写，不能用下划线开头，不能包含逗号。</li> <li>Type：类型，类似数据库结构中的表。</li> <li>Document：文档，Elasticsearch 中的最小数据单元，类似数据库结构中的一行数据。</li> <li>Shard：分片。全称 primary shards（一般用在写操作）。Elasticsearch 可以将一个 Index 中的 Document 数据切分为多个 shard，分布在多台服务器上存储。
创建的时候可以指定分片数量，创建完成后是不可修改的。</li> <li>Replica：副本。全称 replica shards（一般读操作可以被分配到进行使用）。Replica 主要用来保证高可用（故障转移）、数据备份、增强高吞吐的并行搜索。</li></ul> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <ul><li>elasticsearch</li> <li>kibana port:5601
<blockquote><p>下载版本要和es保持一致，否则运行不起来；
修改config/kibana.yml配置 server.host、elasticsearch.url ...
运行 ./bin/kibana</p></blockquote></li></ul> <h2 id="运行"><a href="#运行" class="header-anchor">#</a> 运行</h2> <ul><li>默认情况下es是不允许root账户启动的，需要为es配置独立的账户和组
<blockquote><p>groupadd elasticsearch_group<br>
useradd elasticsearch_user -g elasticsearch_group -s /sbin/nologin</p></blockquote></li> <li>命令
<blockquote><p>bin/elasticsearch -d<br>
./bin/kibana</p></blockquote></li></ul> <h2 id="操作"><a href="#操作" class="header-anchor">#</a> 操作</h2> <ul><li>查询集群健康状况：GET /_cat/health?v
<ul><li>默认集群名字：elasticsearch
集群颜色状态-绿色，最健康的状态，代表所有的分片包括备份都可用；黄色，基本的分片可用，但是备份不可用（也可能是没有备份）；红色，部分的分片可用，表明分片有一部分损坏。此时执行查询部分数据仍然可以查到，遇到这种情况，还是赶快解决比较好。</li></ul></li> <li>查询集群中有哪些索引：GET /_cat/indices?v</li> <li>查询分片：GET /_cat/shards</li> <li>新增索引：PUT /user_index
<ul><li>指定分片数和副本（分片数不可修改）</li></ul> <div class="language- extra-class"><pre class="language-text"><code>        PUT /user_index
        {
        &quot;settings&quot;: {
            &quot;index&quot;: {
            &quot;number_of_shards&quot;: 5,
            &quot;number_of_replicas&quot;: 1
            }
        }
        }
</code></pre></div><ul><li>修改副本</li></ul> <div class="language- extra-class"><pre class="language-text"><code>        PUT /user_index/_settings
        {
            &quot;number_of_replicas&quot;: 2
        }
</code></pre></div><ul><li>设置type/document
<ul><li><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/mapping-intro.html" target="_blank" rel="noopener noreferrer">字段类型传送门<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>属性
<ul><li>index：可选值为analyzed/no/not_analyzed，analyzed:首先分析字符串，然后索引它。换句话说，以全文索引这个域。
not_analyzed:索引这个域，所以它能够被搜索，但索引的是精确值。不会对它进行分析。no:不索引这个域。这个域不会被搜索到。
string 域 index 属性默认是 analyzed 。如果我们想映射这个字段为一个精确值，我们需要设置它为 not_analyzed ：</li> <li>boost：默认为1，定义了文档中该字段的重要性，越高越重要</li> <li>include_in_all：指定该字段是否应该包括在_all字段里头，默认情况下都会包含。</li> <li>对于 analyzed 字符串域，用 analyzer 属性指定在搜索和索引时使用的分析器,默认使用 standard 分析器， 但你可以指定一个内置的分析器替代它。</li></ul></li></ul></li></ul> <div class="language- extra-class"><pre class="language-text"><code>PUT /user_index
{
    &quot;settings&quot;:{
        同上....
    },
   &quot;mappings&quot;: {
        &quot;user&quot;: {
            &quot;properties&quot;: {
                &quot;id&quot;: {
                &quot;type&quot;: &quot;text&quot;
                },
                &quot;user_name&quot;: {
                &quot;type&quot;: &quot;keyword&quot;,
                &quot;boost&quot;: 5
                },
                &quot;user_desc&quot;: {
                &quot;type&quot;: &quot;text&quot;
                },
                &quot;age&quot;: {
                &quot;type&quot;: &quot;byte&quot;
                },
                &quot;created_time&quot;: {
                &quot;type&quot;: &quot;date&quot;,
                &quot;format&quot;: &quot;yyyy-MM-dd HH:mm:ss&quot;
                },
                &quot;update_time&quot;: {
                &quot;type&quot;: &quot;date&quot;,
                &quot;format&quot;: &quot;yyyy-MM-dd HH:mm:ss&quot;
                }
            }
        }
     }
}

</code></pre></div></li> <li>在已有的mapping中增加域<div class="language- extra-class"><pre class="language-text"><code>PUT /user_index/_mapping/user
    {
    &quot;properties&quot; : {
        &quot;introduce&quot; : {
        &quot;type&quot; :    &quot;text&quot;
        }
    }
    }
</code></pre></div></li> <li>删除指定索引：DELETE /user_index</li> <li>删除指定多个索引：DELETE /user_index,db_index</li> <li>删除匹配符索引：DELETE /user_*</li> <li>删除所有索引：DELETE /_all</li> <li>查询索引配置信息：GET /user_index/_settings</li> <li>查询所有索引配置信息：GET /_all/_settings</li></ul> <h2 id="其他"><a href="#其他" class="header-anchor">#</a> 其他</h2> <ul><li>使用/_cat/nodes来查看所有node的情况
<blockquote><p>http://172.25.50.69:9200/_cat/nodes?v</p></blockquote></li> <li>分片情况
<blockquote><p>http://172.25.50.69:9200/_cat/shards?v</p></blockquote></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.f7a9413c.js" defer></script><script src="/blog/assets/js/2.ddedf7b8.js" defer></script><script src="/blog/assets/js/15.e4a62733.js" defer></script>
  </body>
</html>
