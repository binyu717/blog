<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>推荐 | JAVA之路</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="shortcut icon" type="image/x-icon" href="./avatar.png">
    <meta name="description" content="行你所行，听从你心">
    
    <link rel="preload" href="/blog/assets/css/0.styles.b6bfb1ac.css" as="style"><link rel="preload" href="/blog/assets/js/app.f7a9413c.js" as="script"><link rel="preload" href="/blog/assets/js/2.ddedf7b8.js" as="script"><link rel="preload" href="/blog/assets/js/19.4093ac92.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.28823f80.js"><link rel="prefetch" href="/blog/assets/js/11.907d6de2.js"><link rel="prefetch" href="/blog/assets/js/12.e0480859.js"><link rel="prefetch" href="/blog/assets/js/13.197b8968.js"><link rel="prefetch" href="/blog/assets/js/14.327ec1cf.js"><link rel="prefetch" href="/blog/assets/js/15.e4a62733.js"><link rel="prefetch" href="/blog/assets/js/16.7e8254c4.js"><link rel="prefetch" href="/blog/assets/js/17.a5fd2c58.js"><link rel="prefetch" href="/blog/assets/js/18.09512bd4.js"><link rel="prefetch" href="/blog/assets/js/20.0a325460.js"><link rel="prefetch" href="/blog/assets/js/21.41949fa9.js"><link rel="prefetch" href="/blog/assets/js/22.aebd4cfb.js"><link rel="prefetch" href="/blog/assets/js/23.f9a7fbea.js"><link rel="prefetch" href="/blog/assets/js/24.e1b48ee8.js"><link rel="prefetch" href="/blog/assets/js/25.b990b784.js"><link rel="prefetch" href="/blog/assets/js/26.a87045c1.js"><link rel="prefetch" href="/blog/assets/js/27.054622f5.js"><link rel="prefetch" href="/blog/assets/js/28.641f720a.js"><link rel="prefetch" href="/blog/assets/js/29.4b365e5d.js"><link rel="prefetch" href="/blog/assets/js/3.b2bfae33.js"><link rel="prefetch" href="/blog/assets/js/30.46ac7154.js"><link rel="prefetch" href="/blog/assets/js/31.396b63a7.js"><link rel="prefetch" href="/blog/assets/js/32.27b8aea8.js"><link rel="prefetch" href="/blog/assets/js/33.2bdab81b.js"><link rel="prefetch" href="/blog/assets/js/34.0c7b821a.js"><link rel="prefetch" href="/blog/assets/js/35.2c48d1d3.js"><link rel="prefetch" href="/blog/assets/js/4.fbcf4621.js"><link rel="prefetch" href="/blog/assets/js/5.ec4b3f90.js"><link rel="prefetch" href="/blog/assets/js/6.27888615.js"><link rel="prefetch" href="/blog/assets/js/7.e23a1d77.js"><link rel="prefetch" href="/blog/assets/js/8.1314a140.js"><link rel="prefetch" href="/blog/assets/js/9.4472f6b1.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.b6bfb1ac.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">JAVA之路</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://caibaojian.com/vuepress/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vuepress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://caibaojian.com/vuepress/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vuepress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>java</span> <span class="arrow down"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mysql</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>oracle</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>postgresql</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>web</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mybatis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>maven</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>nginx</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>windows</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>单元测试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>问题积累</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>读书笔记</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="推荐"><a href="#推荐" class="header-anchor">#</a> 推荐</h2> <ul><li><a href="http://www.nginx.cn/doc/" target="_blank" rel="noopener noreferrer">nginx中文文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://mp.weixin.qq.com/s/L32QRHYw9FiDJ41L0nGdTw" target="_blank" rel="noopener noreferrer">超详细 Nginx 极简教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/jingmoxukong/p/5945200.html" target="_blank" rel="noopener noreferrer">超详细Nginx简易教程，一学就会！<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="配置文件详解"><a href="#配置文件详解" class="header-anchor">#</a> 配置文件详解</h2> <h3 id="文件大致结构"><a href="#文件大致结构" class="header-anchor">#</a> 文件大致结构：</h3> <div class="language- extra-class"><pre><code>    ```xml
        【main部分】

    events｛
        【events部分】
    ｝

    http｛
          server｛
            【server1配置】
         ｝

        server｛
            【server2配置】
        ｝
    ｝
    ```
- 
</code></pre></div><h3 id="main部分"><a href="#main部分" class="header-anchor">#</a> main部分</h3> <div class="language-xml extra-class"><pre class="language-xml"><code>    # 配置用户
    #user  nobody; 

    # 允许生成的进程数，默认为1
    worker_processes  1;

    # 指定全局日志路径，级别，级别有debug|info|notice|warn|error|crit|alert|emerg
    #error_log  logs/error.log;
    #error_log  logs/notice.log  notice;
    #error_log  logs/info.log  info;

    # PID文件,指定nginx进程运行文件存放地址,记录当前启动的nginx的进程ID
    #pid        logs/nginx.pid;
</code></pre></div><h3 id="event部分"><a href="#event部分" class="header-anchor">#</a> event部分</h3> <div class="language-xml extra-class"><pre class="language-xml"><code>    # 工作模式及连接数上限
    events {
     # 定义每个worker进程最大并发连接数
        worker_connections  1024;                      
    }
</code></pre></div><h3 id="http部分"><a href="#http部分" class="header-anchor">#</a> http部分</h3> <ul><li>在server段外定义的配置，对所有server生效。</li> <li>server_name    指定虚拟主机名。相当于httpd虚拟主机段中的ServerName
<blockquote><p>主机名可以通过精确主机名、左侧使用通配、右侧使用通配、正则表达式匹配来确定</p></blockquote></li> <li>index index.html 首页</li> <li>root 指定页面文件根目录</li> <li>listen 指定监听的地址、端口
<blockquote><p>default_server 设置默认虚拟主机，即当没有虚拟主机符合请求时，使用默认虚拟主机响应<br>
rcvbuf=SIZE 接收缓冲区大小<br>
sndbuf=SIZE 发送缓冲区大小<br>
ssl 限制仅能通过ssl连接进行服务，即提供https服务。这时监听的端口应指定为443</p></blockquote></li> <li>location<div class="language-xml extra-class"><pre class="language-xml"><code>    location = / {                        # 仅当URI为&quot;/&quot;时,使用
        root D:java/web;
         expires 30d;                     # 过期30天，
    }

    location / {                          # URI为&quot;/&quot;下包含的路径时，使用B配置
        [ configuration B ]
    }

    location /documents/ {                # URI为&quot;/documents/&quot;下包含的路径时，使用C配置
        [ configuration C ]
    }

    location ^~ /images/ {               # URI靠前部分为&quot;/images/&quot;，使用D配置
        [ configuration D ]
    }

    location ~* \.(gif|jpg|jpeg)$ {      # URI结尾是gif、jpg或jpeg时，使用E配置
        [ configuration E ]
    }
   location ~ /.ht {                     # 禁止访问 .htxxx 文件
       deny all;
   }
</code></pre></div></li> <li>错误处理页面（可选择性配置）</li></ul> <div class="language-xml extra-class"><pre class="language-xml"><code>    #error_page   404              /404.html;
    #error_page   500 502 503 504  /50x.html;
    #location = /50x.html {
    #    root   html;
    #}
</code></pre></div><h2 id="常用命令"><a href="#常用命令" class="header-anchor">#</a> 常用命令</h2> <ul><li>nginx -s stop ：快速关闭Nginx，可能不保存相关信息，并迅速终止web服务。</li> <li>nginx -s quit ：平稳关闭Nginx，保存相关信息，有安排的结束web服务。</li> <li>nginx -s reload ：因改变了Nginx相关配置，需要重新加载配置而重载。</li> <li>nginx -s reopen ：重新打开日志文件。</li> <li>nginx -c filename ：为 Nginx 指定一个配置文件，来代替缺省的。</li> <li>nginx -t ：不运行，而仅仅测试配置文件。nginx 将检查配置文件的语法的正确性，并尝试打开配置文件中所引用到的文件。</li> <li>nginx -v：显示 nginx 的版本。</li> <li>nginx -V：显示 nginx 的版本，编译器版本和配置参数。</li></ul> <h2 id="应用实例"><a href="#应用实例" class="header-anchor">#</a> 应用实例</h2> <h3 id="http服务器"><a href="#http服务器" class="header-anchor">#</a> HTTP服务器</h3> <ul><li>Nginx本身也是一个静态资源的服务器，可以通过Nginx来实现动静分离<br>
配置样例：<div class="language-xml extra-class"><pre class="language-xml"><code>         upstream test{  
            server localhost:8080;  
            server localhost:8081;  
        }
        server {  
            listen   80;  
            server_name  localhost;  
            location / {  
                root   /usr/share/nginx/html;  
                index  index.html;  
            }  
            
            # 所有静态请求都由nginx处理，存放目录为html  
            location ~ .(gif|jpg|jpeg|png|bmp|swf|css|js)$ {  
                root /usr/share/nginx/html; # 静态文件路径  
            }  
        
            # 所有动态请求都转发给tomcat处理  
            location ~ .(jsp|do)$ {  
                proxy_pass  http://test;  
            }  

            error_page   500 502 503 504 /50x.html;  
            location = /50x.html {  
                root   /usr/share/nginx/html;  
            }  
        } 
        
</code></pre></div></li></ul> <h3 id="反向代理服务器"><a href="#反向代理服务器" class="header-anchor">#</a> 反向代理服务器</h3> <ul><li>反向代理（Reverse Proxy）方式是指以代理服务器来接受internet上的连接请求，然后将请求转发给内部网络上的服务器，并将从服务器上得到的结果返回给internet上请求连接的客户端，此时代理服务器对外就表现为一个反向代理服务器。<br>
配置样例：<div class="language-xml extra-class"><pre class="language-xml"><code>       server{
               listen 80; # 端口号
               server_name  localhost;                                               
               client_max_body_size 1024M;
               location /{
                   proxy_pass http://localhost:8080;# 应用服务器http地址
               }
       }
</code></pre></div></li></ul> <h3 id="负载均衡"><a href="#负载均衡" class="header-anchor">#</a> 负载均衡</h3> <ul><li>Nginx可以通过反向代理将用户的请求分配给多台机器处理，来实现负载均衡。Nginx目前支持自带3种负载均衡策略,例外还有fair、url_hash第三方策略
配置样例：
<blockquote><p>1、RR（默认）</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code>        upstream test {
            server localhost:8080;
            server localhost:8081;
        }
</code></pre></div><blockquote><p>2、权重</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code>        upstream myweb{
            # #weigth参数表示权值，权值越高被分配到的几率越大
            server 172.25.25.1:8080 weight=9;
            server 172.25.25.2:8080 weight=1;
        }
        server{
                listen 80; # 端口号
                location /{
                    proxy_pass http://myweb; # 应用服务器http地址
                }
        }
</code></pre></div><blockquote><p>3、ip_hash iphash的每个请求按访问ip的hash结果分配，这样每个访客固定访问一个后端服务器，可以解决session的问题。</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code>      upstream myweb{
            ip_hash;
            server 172.25.25.1:8080 weight=9;
            server 172.25.25.2:8080 weight=1;
        }
</code></pre></div></li></ul> <h3 id="虚拟主机"><a href="#虚拟主机" class="header-anchor">#</a> 虚拟主机</h3> <ul><li>多个网站部署在同一台服务器上时,两个域名解析到同一个IP地址，但是用户通过两个域名却可以打开两个完全不同的网站。<br>
配置样例：<div class="language-xml extra-class"><pre class="language-xml"><code>    server{
                listen 80 default_server; # 端口号
                server_name _;
                return 444; # 过滤其他域名请求，返回444状态码(过滤有人恶意将某些域名指向你的主机服务器)
        }
    server{
            listen 80 ; # 端口号
            server_name www.aaa.com 
            location /{
                proxy_pass http://localhost:8080; # 对应端口号
            }
    }
    server{
            listen 80 ; # 端口号
            server_name www.bbb.com 
            location /{
                proxy_pass http://localhost:8081; # 对应端口号
            }
    }
</code></pre></div></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.f7a9413c.js" defer></script><script src="/blog/assets/js/2.ddedf7b8.js" defer></script><script src="/blog/assets/js/19.4093ac92.js" defer></script>
  </body>
</html>
